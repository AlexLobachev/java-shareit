DROP TABLE BOOKING;
DROP TABLE COMMENTS;
DROP TABLE  ITEM;
DROP TABLE USERS;





CREATE TABLE IF NOT EXISTS USERS (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    name VARCHAR(255) NOT NULL,
    email VARCHAR(512) NOT NULL,
        UNIQUE (email),
        CONSTRAINT owner_id PRIMARY KEY(id)
    );

CREATE TABLE IF NOT EXISTS ITEM(
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    name VARCHAR(255) NOT NULL,
    description VARCHAR(255) NOT NULL,
    available BOOLEAN,
    CONSTRAINT item_id PRIMARY KEY(id),
    owner_id INTEGER REFERENCES USERS (id));



CREATE TABLE IF NOT EXISTS BOOKING(
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    start_time TIMESTAMP,
    end_time TIMESTAMP,
    item_id INTEGER REFERENCES ITEM (id),
    owner_id INTEGER REFERENCES USERS (id),
    status VARCHAR(255) NOT NULL);

CREATE TABLE IF NOT EXISTS COMMENTS(
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    comments VARCHAR(255) NOT NULL,
    author_name VARCHAR(255) NOT NULL,
    item_id INTEGER REFERENCES ITEM (id)
   );

CREATE TABLE IF NOT EXISTS REQUESTS(
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    description VARCHAR(255) NOT NULL,
    requestor VARCHAR(255) NOT NULL ,
    created TIMESTAMP );




--select owner_id from BOOKING where item_id = 1 and status = 'APPROVED' or status = 'CANCELED' or end_time >  '2008-09-01' group by owner_id

select * from BOOKING where end_time = '2022-08-26' ::date and owner_id = 4